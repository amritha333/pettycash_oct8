{% extends "super_admin/cal_menu.html" %}
{% load static %}
{% block content %}
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.4.0/fullcalendar.css"/>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.18.1/moment.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.4.0/fullcalendar.min.js"></script>


    <!-- App favicon -->
    <link rel="shortcut icon" href="{% static 'calendar/images/fav.png' %}">

    <!-- App css -->

    <link href="{% static 'calendar/css/bootstrap.min.css' %}" rel="stylesheet" type="text/css" />
    <link href="{% static 'calendar/css/icons.css' %}" rel="stylesheet" type="text/css" />
    <link href="{% static 'calendar/css/style.css' %}" rel="stylesheet" type="text/css" />
    <link href="{% static 'calendar/css/app.min.css' %}" id="app-style" rel="stylesheet" type="text/css" />
    <!-- Plugins css -->
    <link href="{% static 'calendar/plugins/lightpick/lightpick.css' %}" rel="stylesheet" />
    <link href="{% static 'calendar/plugins/app.min.css' %}" rel="stylesheet" />

    <link href="https://fonts.googleapis.com/css?family=Muli:400,600,700,800" rel="stylesheet">

    <script src="https://kit.fontawesome.com/217e433c71.js" crossorigin="anonymous"></script>

    <div class="row">
        <div class="col-12">
            <div class="box_header">
                <div class="row">
                    <div class="col-md-7 col-12">
                        <div class="mainiconbox"><i class="fa fa-calendar"></i>
                        </div>
                        <h4 class="m-t-0 header-title">
                            <div class="breadcrumbs ng-scope">
                                <ul>
                                    <li><a href="index.html">Home</a></li>
                                    <li><a>Leave Calendar</a></li>
                                </ul>
                                <div>Leave Calendar</div>
                            </div>
                        </h4>
                    </div>
                </div>
            </div>
            <div class="card-box">
                <div class="row">
                    <div class="col-12">
                        <div class="row">
                            <div class="col-xl-9">
                                <div class="card card-h-100">
                                    <div class="card-body">
                                        <div id="calendar"></div>
                                        <div id="leave_id"></div>
                                        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.3/umd/popper.min.js" integrity="sha384-vFJXuSJphROIrBnz7yo7oB41mKfc8JzQZiCq4NCceLEaO4IHwicKwpJf9c9IpFgh" crossorigin="anonymous"></script>
                                        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/js/bootstrap.min.js" integrity="sha384-alpBpkh1PFOepccYVYDB4do5UnbKysX5WZXm3XxPqe5iKTfUKjNkCk9SaVuEZflJ" crossorigin="anonymous"></script>
                                    </div>
                                </div>
                            </div> <!-- end col -->
                            <div class="col-xl-3">
                                <div class="dash-datepick mb-3">
<!--                                                    <input type="hidden" id="light_datepick" />-->
                                    <div id="light_datepick"></div>
                                </div>
                                <div id="sub" ></div>
                                <div class="card card-h-100">
                                    <div class="card-body">


                                        <div id="external-events">

                                            <div class="external-event fc-event bg-success"
                                                data-class="bg-success">
                                                <i class="fa fa-circle font-size-10 mr-2"></i>Validated
                                            </div>
                                            <div class="external-event fc-event bg-info"
                                                data-class="bg-info">
                                                <i class="fa fa-circle font-size-10 mr-2"></i>To Validate
                                            </div>
                                            <div class="external-event fc-event bg-warning"
                                                data-class="bg-warning">
                                                <i class="fa fa-circle font-size-10 mr-2"></i>Submission Confirmed
                                            </div>
                                            <div class="external-event fc-event bg-danger"
                                                data-class="bg-danger">
                                                <i class="fa fa-circle font-size-10 mr-2"></i>Refused
                                            </div>

                                            <div class="external-event fc-event bg-dark"
                                                data-class="bg-danger">
                                                <i class="fa fa-circle font-size-10 mr-2"></i>Draft
                                            </div>
                                        </div>

                                    </div>
                                </div>
                            </div> <!-- end col-->


                        </div>

                        <div style='clear:both'></div>

                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- end row -->
    <script src="{% static 'calendar/plugins/moment.js' %}"></script>
    <script src="{% static 'calendar/js/pages/calendar.init.js' %}"></script>
    <script src="{% static 'calendar/plugins/lightpick/lightpick.js' %}"></script>
    <script src="{% static 'calendar/plugins/jquery.calendar.js' %}"></script>

    <style>
        .fc-time{
            display: none!important;
        }

        .fc-today span{
            background-color: #6e56a3;
            color: #fff;
            width: 15px;
            height: 15px;
            border-radius: 50%;
            padding: 0;
            display: -webkit-box;
            display: -ms-flexbox;
            display: flex;
            -webkit-box-align: center;
            -ms-flex-align: center;
            align-items: center;
            -webkit-box-pack: center;
            -ms-flex-pack: center;
            justify-content: center;
            font-size: 12px;
            font-weight: 500;
            margin: 2px;
        }

        .fc-button {
            background: #6e56a3;
            border: 1px solid #6e56a3;
            color: #ffffff;
            font-family: inherit;
            text-transform: capitalize;
        }

        tr:first-child>td>.fc-day-grid-event {
            border-left: 0px solid!important;
        }

        .fc-button:hover, .fc-state-default:hover {
            background: #513c81!important;
            color: #fff!important;
            border-color: #fff!important;
        }
        .fc-state-active{
            box-shadow: 0 0 0 2px rgb(89 69 133 / 25%);
            background-color: #513c81;
            border-color: #6e56a3;
        }

        .bg-danger{
            text-decoration:line-through!important;
        }
    </style>



    <script>
        $(document).ready(function () {
            var calendar = $('#calendar').fullCalendar({
                header: {
                    left: 'prev next today',
                    center: 'title',
                    right: 'month,agendaWeek,agendaDay'
                },
                events: '/all_events',
                selectable: true,
                selectHelper: true,
                editable: true,
                eventLimit: true,
                eventClick: function (event) {
                        var id = event.id;
                        var url = $("#personForm").attr("data-cities-url");  // get the url of the `load_cities` view
                        var countryId = $(this).val();  // get the selected country ID from the HTML input
                        $.ajax({                       // initialize an AJAX request
                        url: "event_depended",                    // set the url of the request (= localhost:8000/hr/ajax/load-cities/)
                        data: {
                                'event_id': id       // add the country id to the GET parameters
                        },
                        success: function (data) {   // `data` is the return of the `load_cities` view function
                        $("#leave_id").html(data);  // replace the contents of the city input with the data that came from the server
                        $('#exampleModalLabel').modal('show');
                        }
                    });
                },
            });
        });


        $(document).ready(function(){
            var currentDate = new Date();
            c=new Date(currentDate).toISOString()
            $.ajax({
                url: 'depended',
                data: {
                    'date_emp': c
                },
                type: 'GET',
                success: function (data) {
                    $("#sub").html(data);
                }
            });
        });


        $('body').on('click', 'button.fc-prev-button', function() {
            var b = $('#calendar').fullCalendar('getDate');
            c=new Date(b).toISOString()
            $.ajax({
                url: 'depended',
                data: {
                    'date_emp': c

                },
                type: 'GET',
                success: function (data) {
                    $("#sub").html(data);
                }
            });
        });



        $('body').on('click', 'button.fc-next-button', function() {
            var b = $('#calendar').fullCalendar('getDate');
            c=new Date(b).toISOString()
            $.ajax({
                url: 'depended',
                data: {
                    'date_emp': c
                },
                success: function (data) {
                    $("#sub").html(data);
                }
            });
        });


        $(document).ready(function(){
            $("button").click(function(){
                if(event.target.className == "fc-today-button fc-button fc-state-default fc-corner-left fc-corner-right fc-state-disabled"){
                    var b = $('#calendar').fullCalendar('getDate');
                    c=new Date(b).toISOString()
                    $.ajax({
                        url: 'depended',
                        data: {
                            'date_emp': c
                        },
                        success: function (data) {
                            $("#sub").html(data);
                        }
                    });
                }
            })
        });
    </script>


    <script>

        $(document).on("click", ".check-emp-all", function () {
            if($(this).prop("checked") == true){
                $(".check-emp,.check-emp1").prop("checked", true);
                    $(".check-emp,.check-emp1").each(function(){
                        $(this).prop("checked", true);
                            getServiceFeed1()
                        });
                    }
            else{
                $(".check-emp,.check-emp1").prop("checked", false);
            }
        });
    </script>

    <script>
        function getServiceFeed1(){
            var h1 = document.querySelector("h2").innerText;
            var ricksDate = new Date(h1);
            var all = document.getElementById("all").value
            $('#calendar').fullCalendar('destroy');
            var calendar = $('#calendar').fullCalendar({
                    header: {
                        left: 'prev next today',
                        center: 'title',
                        right: 'month,agendaWeek,agendaDay'
                    },
                    events: '/all_events',
                    selectable: true,
                    selectHelper: true,
                    editable: true,
                    eventLimit: true,
                    defaultDate: ricksDate,
                    eventClick: function (event) {
                            var id = event.id;
                            var url = $("#personForm").attr("data-cities-url");  // get the url of the `load_cities` view
                            var countryId = $(this).val();  // get the selected country ID from the HTML input
                            $.ajax({                       // initialize an AJAX request
                            url: "event_depended",                    // set the url of the request (= localhost:8000/hr/ajax/load-cities/)
                            data: {
                                    'event_id': id       // add the country id to the GET parameters
                            },
                            success: function (data) {   // `data` is the return of the `load_cities` view function
                            $("#leave_id").html(data);  // replace the contents of the city input with the data that came from the server
                            $('#exampleModalLabel').modal('show');
                            }
                            });
                    },

            });
        }
    </script>
{% endblock %}